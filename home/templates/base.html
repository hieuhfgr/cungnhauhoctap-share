<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cùng Nhau Học Tập - {% block title %}{% endblock %}</title>
    <link rel="icon" href="{% static 'images/icon-website.png' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <link rel="stylesheet" href="{% static 'css/bootstrap/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/base.css' %}">
    {% block css-js %}{% endblock %}
</head> 
<body>
    <div class='container main-content'>
        <nav class="menu navbar navbar-expand-lg navbar-light">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
          
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <ul class="navbar-nav mr-auto">
                <li class="nav-item {% block nav-home %}{% endblock %}">
                  <a class="nav-link " href="/">Trang Chủ</a>
                </li>
          
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle {% block nav-about-drop %}{% endblock %}" href="/about" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      Giới Thiệu
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                      <a class="dropdown-item {% block nav-about %}{% endblock %}" href="/about">Về Trang Web</a>
                      <a class="dropdown-item {% block nav-announcement %}{% endblock %}" href="/announcement">Thông Báo</a>
                      <a class="dropdown-item {% block nav-team %}{% endblock %}" href="/about/team">Đội Ngũ</a>
                      <a class="dropdown-item {% block nav-faq %}{% endblock %}" href="/about/faq">Câu Hỏi Thường Gặp</a>
                      <a class="dropdown-item {% block nav-support %}{% endblock %}" href="/about/support">Hỗ Trợ</a>
          
                    </div>
                  </li>
          
                  <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle {% block nav-profile-drop %}{% endblock %}" href="/profile" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      Hồ Sơ
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                      <a class="dropdown-item {% block nav-search-user %}{% endblock %}" href="/profile/search">Tìm Kiếm người Dùng</a>
                      <a class="dropdown-item {% block nav-activemember %}{% endblock %}" href="/profile/topusers">Top Thành Viên</a>
                    </div>
                  </li>

                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle {% block nav-hoctap-drop %}{% endblock %}" href="/hoctap" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      Tài Liệu
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                      <a class="dropdown-item {% block nav-hoctap-post %}{% endblock %}" href="/hoctap/posts">Học Tập - Trang Chủ</a>
                      <a class="dropdown-item {% block nav-hoctap-post-search %}{% endblock %}" href="/hoctap/post/search">Học Tập - Tìm Kiếm</a>
                      <a class="dropdown-item {% block nav-hoctap-post-create %}{% endblock %}" href="/hoctap/post/create">Học Tập - Tạo Mới</a>
                      <div class="dropdown-divider"></div>
                      <a class="dropdown-item {% block nav-hoctap-test %}{% endblock %}" href="/hoctap/test">Kiểm Tra - Trang Chủ</a>
                      <a class="dropdown-item {% block nav-hoctap-test-search %}{% endblock %}" href="/hoctap/test/search">Kiểm Tra - Tìm Kiếm</a>
                      <a class="dropdown-item {% block nav-hoctap-test-create %}{% endblock %}" href="/hoctap/test/create">Kiểm Tra - Tạo Mới</a>
                    </div>
                  </li>

                <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle {% block nav-hoctap-other-drop %}{% endblock %}" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Khác
                  </a>
                  <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item {% block nav-hoctap-todo %}{% endblock %}" href="/hoctap-others/todo/">Nội Dung Học Tập</a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item {% block nav-hoctap-news %}{% endblock %}" href="/hoctap-others/news/">Trang Tin</a>
                  </div>
                </li>

              </ul>
            </div>

            <!-- register  -->
            <div>
              {% if user.username %} 
                <h6>Xin Chào <a href="/profile/detail/{{user.username}}">{{user.username}}</a> | <a href="/logout">Đăng Xuất</a></h6>
              {% else %} 
                <h6><a href="/login">Đăng Nhập</a> hoặc <a href="/register">Đăng Kí</a></h6>
              {% endif %}
            </div>
        </nav>

                  
        <div class="row" style="min-height: 27rem;">
          <div class="col-md-2">
              <!-- To Do  -->
              {% if user.is_authenticated %}
              <div class="side-content">
                      <h6 class="ml-1">Nội Dung Học Tập</h6>
                      <div style="overflow-y:auto; max-height:20em">
                      <table class="table table-sm table-hover table-format">
                          <thead>
                              <tr>
                                  <td style="width: 90%">Tiêu Đề</td>
                                  <td style="width: 10%"></td>
                              </tr>
                          </thead>
                          <tbody>
                              {% for list in todo %}
                                  <tr>
                                      {% if list.is_finished == False %} 
                                          <td><a href="/hoctap-others/todo/detail/{{list.id}}/">{{list.title}}</a></td>
                                          <td class="text-center">
                                              <form method="post">
                                                  {% csrf_token %}
                                                  <button class="btn btn-sm btn-primary" type="submit" name="todo" value="{{list.id}}">
                                                      xong
                                                  </button>
                                              </form>
                                          </td>
                                      {% else %}
                                          <td><del><a href="/hoctap-others/todo/detail/{{list.id}}/">{{list.title}}</a></del></td>
                                          <td class="text-center">
                                            <i class="fas fa-check"></i>
                                          </td>
                                      {% endif %}
                                  </tr>
                              {% endfor %}
                          </tbody>
                      </table>
                      </div>
                  </div>
              {% endif %}
              
              <!-- info -->
              <div class="side-content">
                <h6 class="ml-1">Thông Tin</h6>
                <table class="table table-sm table-hover table-format">
                    <tbody>
                      {% for item in info %}
                      <tr>
                        <td>{{item|safe}}</td>
                      </tr>
                      {% endfor %}
                    </tbody>
                </table>
              </div>

          </div>
          <div class="col-md-7">
            {% block content %}
            {% endblock %}
          </div>
          <div class="col-md-3">
                  <!-- new announcements -->
                  <div class="side-content">
                      <h6 class="ml-1">Thông Báo Từ Quản Trị Viên</h6>
                      <div style="overflow-y:auto; max-height:15em">
                      <table class="table table-sm table-bordered table-hover table-format">
                          <thead>
                              <tr>
                                  <td>Tiêu Đề</td>
                              </tr>
                          </thead>
                          <tbody>
                                  {% for announcement in announcements %}
                                      <tr>
                                          <td><a href="/announcement/{{ announcement.id }}">{{ announcement.title|capfirst }}</a></td>
                                      </tr>   
                                  {% endfor %}
                          </tbody>
                      </table>
                      </div>
                  </div>
                  
                  <!-- Notication -->
                  {% if user.is_authenticated %}
                  <div class="side-content">
                      <h6 class="ml-1">Thông Báo Của Bạn</h6>
                      <div style="overflow-y:auto; max-height:15em">
                      <table class="table table-sm table-bordered table-hover table-format">
                          <thead>
                              <tr>
                                  <td style="width: 90%">Nội Dung</td>
                                  <td style="width: 10%"></td>

                              </tr>
                          </thead>
                          
                          <tbody>
                              {% for notification in notifications %}
                                      <tr>
                                          <td>
                                              {{notification.content|safe}}
                                          </td>
                                          <td class="text-center">
                                          <form action="." method="post">
                                              {% csrf_token %}
                                              <button class="btn btn-sm btn-outline-dark" type="submit" name="notification" value="{{notification.id}}">Đi Tới...</button>
                                          </form>
                                          </td>
                                      </tr>
                              {% endfor %}  
                          </tbody>
                      </table>
                      </div>
                  </div>
                  {% endif %}

                  
                  <!-- Top Users -->
                  <div class="side-content">
                      <h6 class="ml-1">Top Thành Viên</h6>
                      <table class="table table-sm table-bordered table-hover table-format">
                          <thead>
                              <tr>
                                  <td class="text-center" style="width: 10%">#</td>
                                  <td style="width: 65%">Tên truy cập</td>
                                  <td class="text-center" style="width: 25%">Số bài viết</td>
                              </tr>
                          </thead>
                          <tbody>
                              {% for member in topUsers %}
                                      <tr>
                                          <td class="text-center">{{ forloop.counter }}</td>
                                          <td>
                                              <a href="/profile/detail/{{member.username}}">{{ member.username}}</a>
                                              {% if member.rank == 'A' %} 
                                              <img src="/media/images/rank/gold.png" style="height: 1.5em; width: auto" alt="rank gold">
                                              {% elif member.rank == 'B' %}
                                              <img src="/media/images/rank/silver.png" style="height: 1.5em; width: auto" alt="rank silver">
                                              {% elif member.rank == 'C' %} 
                                              <img src="/media/images/rank/bronze.png" style="height: 1.5em; width: auto" alt="rank bronze">
                                              {% endif %}
                                          </td>
                                          <td class="text-center">{{member.NumberOfPosts}}</td>
                                      </tr>
                              {% endfor %}  
                          </tbody>
                      </table>
                  </div>
                  
                  
          </div>
        </div>
        
        <hr>
        {% include 'footer.html' %}
    </div>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
</body>
</html>